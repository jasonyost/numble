/*
 *  numble - v1.1.0
 *  Simple jQuery number selector
 *  https://github.com/jasonyost/numble#readme
 *
 *  Made by 
 *  Under MIT License
 */
!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.incrementable=function(){var b=parseInt(a(this.element).val()),c=this.canIncrement(b,this.settings);return this.debugMessage("incrementable called : "+c),c},this.decrementable=function(){var b=parseInt(a(this.element).val()),c=this.canDecrement(b,this.settings);return this.debugMessage("incrementable called : "+c.can),c.can},this.init()}var f="numble",g={debug:!1,includeButtons:!0,allowNegative:!0,maxValue:d,minValue:d,initialValue:d,allowScroll:!0,incrementText:"&#x25B2;",decrementText:"&#x25BC;",allowEdit:!0,hideButtonsOnMinMax:!1};a.extend(e.prototype,{init:function(){var a=this;a.debugMessage("numble initialized"),a.initDom(a.element,a.settings),a.bindElementChange(a.element,a.settings),a.bindNumbleScroll(a.element,a.settings),a.initValue(a.element,a.settings),a.addButtons(a.element,a.settings)},initDom:function(b,c){var d=this;a(b).wrap('<div class="numble-wrapper"></div>'),a(b).addClass("numble-original"),a(b).hide(),a(b).after('<div class="numble-control"><div class="numble-value" '+(c.allowEdit&&!d.isReadonly(b)?"contenteditable":"")+"></div></div>")},bindElementChange:function(b){var c=this,d=c.getNumbleControl(b);a(b).change(function(){c.debugMessage("change detected: "+a(this).val()),d.text(a(this).val());var e=c.getIncrementButton(b),f=c.getDecrementButton(b);c.settings.includeButtons&&c.settings.hideButtonsOnMinMax&&(c.canIncrement(c.getCurrentValue(b),c.settings)?e.show():(console.log(),e.hide()),c.canDecrement(c.getCurrentValue(b),c.settings).can?f.show():f.hide())}),d.keydown(function(a){return String.fromCharCode(a.keyCode).match(/[^0-9]/g)&&8!==a.keyCode?!1:void 0}),d.blur(function(){return d.text()>c.settings.maxValue?(c.debugMessage("value set greater than maxValue, reverting"),void d.text(a(b).val())):d.text()<c.settings.minValue?(c.debugMessage("value set less than minValue, reverting"),void d.text(a(b).val())):void a(b).val(d.text()).trigger("change")})},bindNumbleScroll:function(a,b){var c=this,d=c.getNumbleControl(a);b.allowScroll&&d.bind("mousewheel DOMMouseScroll",function(d){c.debugMessage("received scroll event"),d.originalEvent.wheelDelta>0||d.originalEvent.detail<0?(c.debugMessage("received scroll up event"),c.incrementValue(a)):(c.debugMessage("received scroll down event"),c.decrementValue(a,b)),d.preventDefault()})},initValue:function(b,c){var d=this,e=this.getIntialValue(b,c);d.debugMessage("original value "+e),a(b).val(e),a(b).change()},getNumbleControl:function(b){return a(b).siblings(".numble-control").find(".numble-value")},addButtons:function(b,c){var d=this;if(c.includeButtons){var e=a(b).siblings(".numble-control"),f=d.getCurrentValue(b);e.append('<span class="numble-increment numble-arrow">'+c.incrementText+"</span>"),e.find(".numble-increment").click(function(){d.incrementValue(b)}),c.hideButtonsOnMinMax&&!d.canIncrement(f,c)&&(d.debugMessage("hideButtonsOnMinMax set, current value: "+f+", cannot increment, hiding button"),e.find(".numble-increment").hide()),e.append('<span class="numble-decrement numble-arrow">'+c.decrementText+"</span>"),e.find(".numble-decrement").click(function(){d.decrementValue(b,c)}),c.hideButtonsOnMinMax&&!d.canDecrement(f,c).can&&(d.debugMessage("hideButtonsOnMinMax set, current value: "+f+", cannot decrement, hiding button"),e.find(".numble-decrement").hide())}},canIncrement:function(a,b){return b.maxValue&&a<b.maxValue?!0:b.maxValue?void 0:!0},incrementValue:function(b){var c=this,d=parseInt(a(b).val());return a(b).attr("disabled")||a(b).attr("readonly")?(this.debugMessage("control is disabled/readonly"),!1):void(c.canIncrement(d,c.settings)?(d++,a(b).val(d).trigger("change"),this.debugMessage("incrementing to "+d)):this.debugMessage("maxValue set to "+this.settings.maxValue))},canDecrement:function(a,b){return b.minValue&&a<=b.minValue?{can:!1,message:"minValue set to "+b.minValue}:0===a&&b.allowNegative===!1?{can:!1,message:"allowNegative set to false"}:{can:!0}},decrementValue:function(b,c){var d=this,e=parseInt(a(b).val());if(a(b).attr("disabled")||a(b).attr("readonly"))return this.debugMessage("control is disabled/readonly"),!1;var f=d.canDecrement(e,c);f.can?(e--,a(b).val(e).trigger("change"),this.debugMessage("decrementing to "+e)):this.debugMessage(f.message)},getIntialValue:function(b,c){var d=parseInt(a(b).val())||0;return 0===d&&(d=parseInt(c.initialValue)||0),d},isReadonly:function(b){return a(b).attr("disabled")||a(b).attr("readonly")},debugMessage:function(a){this.settings.debug&&console.log(a)},getCurrentValue:function(b){var c=parseInt(a(b).val());return c},getIncrementButton:function(b){var c=a(b).siblings(".numble-control");return c.find(".numble-increment")},getDecrementButton:function(b){var c=a(b).siblings(".numble-control");return c.find(".numble-decrement")}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);